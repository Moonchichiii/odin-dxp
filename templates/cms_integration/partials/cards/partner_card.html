{% load cloudinary_helper wagtailimages_tags %}

<!--
  NOTE: We removed the fixed width/height here.
  The parent carousel determines the size.
-->
<a
  href="{{ partner.website|default:'#' }}"
  class="partner-link group block w-full h-full relative"
  {% if partner.website %}target="_blank" rel="noopener"{% endif %}
>
  <!-- 1. The Glass Pane -->
  <div class="absolute inset-0 rounded-xl bg-white/[0.03] border border-white/[0.1] backdrop-blur-sm transition-all duration-300 group-hover:bg-white/[0.08] group-hover:border-primary/30 group-hover:shadow-[0_0_30px_rgba(16,185,129,0.15)]"></div>

  <!-- 2. Content -->
  <div class="relative h-full flex flex-col items-center justify-center p-6 text-center z-10">

    <!-- Logo -->
    <div class="h-16 w-full flex items-center justify-center mb-4 transition-transform duration-500 group-hover:scale-110 group-hover:-translate-y-2">
      {% if partner.logo_upload %}
        {% image partner.logo_upload max-300x150 class="max-h-full max-w-full object-contain filter grayscale brightness-150 contrast-125 opacity-70 transition-all duration-300 group-hover:filter-none group-hover:opacity-100" alt=partner.name loading="lazy" %}
      {% elif partner.logo_public_id %}
        <img
          src="{% cld_img partner.logo_public_id width=300 height=150 gravity='auto' %}"
          alt="{{ partner.name }}"
          class="max-h-full max-w-full object-contain filter grayscale brightness-150 contrast-125 opacity-70 transition-all duration-300 group-hover:filter-none group-hover:opacity-100"
          loading="lazy"
        />
      {% else %}
        <span class="text-xs font-mono text-white/30">NO LOGO</span>
      {% endif %}
    </div>

    <!-- Name -->
    <h3 class="text-sm font-bold text-white/60 transition-colors duration-300 group-hover:text-white">{{ partner.name }}</h3>

    {% if partner.tier %}
      <span class="text-[10px] uppercase tracking-widest text-primary/60 mt-1 font-mono">{{ partner.tier }}</span>
    {% endif %}
  </div>

  <!-- 3. Visit Icon (Pops up on hover) -->
  {% if partner.website %}
  <div class="absolute -top-3 -right-3 w-8 h-8 bg-primary rounded-full flex items-center justify-center text-odin-bg shadow-lg opacity-0 scale-0 transition-all duration-300 group-hover:opacity-100 group-hover:scale-100 z-20">
    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg>
  </div>
  {% endif %}
</a>
